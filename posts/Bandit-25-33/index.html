<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OverTheWire - Bandit - Level 25 -&gt; Level 33" /><meta name="author" content="Nasrallah" /><meta property="og:locale" content="en" /><meta name="description" content="Learning journey." /><meta property="og:description" content="Learning journey." /><link rel="canonical" href="https://nasrallahbaadi.github.io/posts/Bandit-25-33/" /><meta property="og:url" content="https://nasrallahbaadi.github.io/posts/Bandit-25-33/" /><meta property="og:site_name" content="Nasrallah" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-15T01:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OverTheWire - Bandit - Level 25 -&gt; Level 33" /><meta name="twitter:site" content="@NasrallahBaadi" /><meta name="twitter:creator" content="@Nasrallah" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Nasrallah"},"dateModified":"2022-07-08T17:56:10+01:00","datePublished":"2022-02-15T01:00:00+01:00","description":"Learning journey.","headline":"OverTheWire - Bandit - Level 25 -&gt; Level 33","mainEntityOfPage":{"@type":"WebPage","@id":"https://nasrallahbaadi.github.io/posts/Bandit-25-33/"},"url":"https://nasrallahbaadi.github.io/posts/Bandit-25-33/"}</script><title>OverTheWire - Bandit - Level 25 -> Level 33 | Nasrallah</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nasrallah"><meta name="application-name" content="Nasrallah"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nasrallah</a></div><div class="site-subtitle font-italic">Learning journey</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/NasrallahBaadi" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/NasrallahBaadi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/NasrallahBaadi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/565048" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Nasrallah" aria-label="TryHackMe" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://t.me/Sirius1337" aria-label="Telegram" target="_blank" rel="noopener"> <i class="fab fa-telegram"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['baadinasrallah','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OverTheWire - Bandit - Level 25 -> Level 33</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>OverTheWire - Bandit - Level 25 -> Level 33</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1644883200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 15, 2022 </em> </span> <span> Updated <em class="" data-ts="1657299370" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 8, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> NasrallahBaadi </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1702 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><hr /><h1 id="description"><strong>Description</strong></h1><p>Hello l33ts, I hope you are doing well. In today’s episode, we will be doing Level 25 -&gt; Level 33 of <a href="https://overthewire.org/wargames/bandit/">Bandit</a> from <a href="https://overthewire.org/wargames/">OverTheWire</a>. Let’s connect to <strong>bandit25</strong> and start.</p><h1 id="level-25---level-26"><strong>Level 25 -&gt; Level 26</strong></h1><h2 id="goal"><span class="mr-2">Goal</span><a href="#goal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 is not /bin/bash, but something else. Find out what it is, how it works and how to break out of it.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>On bandit25’s home directory, we see bandit26.sshkey which is bandit26’s ssh private key. When we try to login using that key, we get logged out after</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="gp">bandit25@bandit:~$</span><span class="w"> </span>ssh <span class="nt">-i</span> bandit26.sshkey bandit26@localhost
<span class="go">Could not create directory '/home/bandit25/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

Linux bandit.otw.local 5.4.8 x86_64 GNU/Linux

      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|
</span><span class="gp">    /   .     :      ,`   .'  :     .--'.  ' ;</span><span class="w">
</span><span class="gp">   .   /   ;</span><span class="nb">.</span>  <span class="se">\ </span>  <span class="p">;</span>    <span class="p">;</span>     /    /__./ <span class="se">\ </span>: |
<span class="gp">  .   ;</span><span class="w">   </span>/  <span class="sb">`</span> <span class="p">;</span> .<span class="s1">'___,/    ,'</span> .--<span class="s1">'.  '</span>   <span class="se">\'</span> <span class="nb">.</span>
<span class="gp">  ;</span><span class="w">   </span>|  <span class="p">;</span> <span class="se">\ </span><span class="p">;</span> | |    :     | /___/ <span class="se">\ </span>|    <span class="s1">' '</span>
<span class="gp">  |   :  | ;</span><span class="w"> </span>| <span class="s1">' ;    |.'</span><span class="p">;</span>  <span class="p">;</span> <span class="p">;</span>   <span class="se">\ </span> <span class="se">\;</span>      :
<span class="gp">  .   |  ' ' ' : `----'  |  |  \   ;</span><span class="w">  </span><span class="sb">`</span>      |
<span class="gp">  '   ;</span><span class="w">  </span><span class="se">\;</span> /  |     <span class="s1">'   :  ;   .   \    .\  ;
</span><span class="go">   \   \  ',  /      |   |  '    \   \   ' \ |
</span><span class="gp">    ;</span><span class="w">   </span>:    /       <span class="s1">'   :  |     :   '</span>  |--<span class="s2">"
</span><span class="gp">     \   \ .'        ;</span><span class="w">   </span><span class="s2">|.'       </span><span class="se">\ </span><span class="s2">  </span><span class="se">\ </span><span class="s2">;
</span><span class="go">  www. `---` ver     '---' he       '---" ire.org


Welcome to OverTheWire!

If you find any problems, please report them to Steven or morla on
irc.overthewire.org.

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us through IRC on
</span><span class="gp">  irc.overthewire.org #</span>wargames.
<span class="go">
  Enjoy your stay!

  _                     _ _ _   ___   __  
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/
Connection to localhost closed.
</span><span class="gp">bandit25@bandit:~$</span><span class="w">
</span></pre></table></code></div></div><p>We know that the shell for bandit26 is not /bin/bash, so let’s check what shell this user has by executing the following.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">bandit25@bandit:~$</span><span class="w"> </span><span class="nb">cat</span> /etc/passwd | <span class="nb">grep</span> <span class="nt">-i</span> bandit26
<span class="go">bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
</span></pre></table></code></div></div><p>The shell in <strong><em>/usr/bin/showtext</em></strong>, let’s see what this binary does.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">bandit25@bandit:~$</span><span class="w"> </span><span class="nb">cat</span> /usr/bin/showtext
<span class="gp">#</span><span class="o">!</span>/bin/sh
<span class="go">
export TERM=linux

more ~/text.txt
exit 0
</span></pre></table></code></div></div><p>This binary set the value of the environmental variable <em>TERM</em> to linux, and then executes the command <code class="language-plaintext highlighter-rouge">more</code> with text.txt which is in bandit26’s home directory.</p><p>According to the man page of <code class="language-plaintext highlighter-rouge">more</code>, the latter is a filter for paging through text one screenful at a time. Reading through the man page in the commands section, we can type v and get vim editor, and that will allow us to execute commands on the system.</p><p><img data-src="/assets/img/overthewire/bandit/v.png" alt="vim" data-proofer-ignore></p><p>For that, we need to be in the command view of more first, to do that, let’s make our terminal small so that the program doesn’t just exit.</p><p><img data-src="/assets/img/overthewire/bandit/small.png" alt="small" data-proofer-ignore></p><p>Now we press the button “<strong>v</strong>” and we get vim editor, we can now put our terminal window to it’s normal size.</p><p><img data-src="/assets/img/overthewire/bandit/vim.png" alt="vi" data-proofer-ignore></p><p>The command we need to execute on vim is <code class="language-plaintext highlighter-rouge">shell</code>, this suppose to give us a shell, but when we run it, we get back into <code class="language-plaintext highlighter-rouge">more</code>, let’s check the value of shell by typing <code class="language-plaintext highlighter-rouge">:set shell ?</code> and hit enter</p><p><img data-src="/assets/img/overthewire/bandit/shel.png" alt="ss" data-proofer-ignore></p><p>When get back <strong>shell=/usr/bin/showtext</strong></p><p><img data-src="/assets/img/overthewire/bandit/show.png" alt="ss" data-proofer-ignore></p><p>Now we now why we got back to more after running shell. We need to set the value of shell to <em>/bin/bash</em> by running <code class="language-plaintext highlighter-rouge">:set shell=/bin/bash</code> and run <code class="language-plaintext highlighter-rouge">:shell</code> after that in order to get our shell.</p><p><img data-src="/assets/img/overthewire/bandit/vimshell.png" alt="sh" data-proofer-ignore></p><h1 id="level-26---level-27"><strong>Level 26 -&gt; Level 27</strong></h1><h2 id="goal-1"><span class="mr-2">Goal</span><a href="#goal-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Good job getting a shell! Now hurry and grab the password for bandit27!</p><h2 id="solution-1"><span class="mr-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After the hard times trying to get a shell for bandit26, we now have one. Listing the content of bandit26’s home directory we see bandit27-do binary with suid permission, running it we get the syntax on how to use it, and just like level 19, running the binary with <code class="language-plaintext highlighter-rouge">id</code> we see that we ran it as bandit27. Let’s get the password for the next level.</p><p><img data-src="/assets/img/overthewire/bandit/bandit27.png" alt="pas" data-proofer-ignore></p><h1 id="level-27---level-28"><strong>Level 27 -&gt; Level 28</strong></h1><h2 id="goal-2"><span class="mr-2">Goal</span><a href="#goal-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a git repository at ssh://bandit27-git@localhost/home/bandit27-git/repo. The password for the user bandit27-git is the same as for the user bandit27.</p><p>Clone the repository and find the password for the next level.</p><h2 id="solution-2"><span class="mr-2">Solution</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s create a directory in <strong>/tmp</strong>, move to it and clone the repository using <code class="language-plaintext highlighter-rouge">git clone ssh://bandit27-git@localhost/home/bandit27-git/repo</code></p><p><img data-src="/assets/img/overthewire/bandit/git.png" alt="git" data-proofer-ignore></p><p>Navigating to repo we find a file named README, and it contains the password for the next level.</p><p><img data-src="/assets/img/overthewire/bandit/repopass.png" alt="git" data-proofer-ignore></p><p>password for the next level : 0ef186ac70e04ea33b4c1853d2526fa2</p><h1 id="level28---level-29"><strong>Level28 -&gt; Level 29</strong></h1><h2 id="goal-3"><span class="mr-2">Goal</span><a href="#goal-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a git repository at ssh://bandit28-git@localhost/home/bandit28-git/repo. The password for the user bandit28-git is the same as for the user bandit28.</p><p>Clone the repository and find the password for the next level.</p><h2 id="solution-3"><span class="mr-2">Solution</span><a href="#solution-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The same steps of the previous level apply here.</p><p>Let’s navigate to <strong>repo</strong> and see what can we find.</p><p><img data-src="/assets/img/overthewire/bandit/29.png" alt="git" data-proofer-ignore></p><p>We found a README.md file but it doesn’t have the password. Since this is a git repository, let’s check the history of changes done to it, run the command <code class="language-plaintext highlighter-rouge">git log</code> inside the <strong>repo</strong> directory.</p><p><img data-src="/assets/img/overthewire/bandit/logs.png" alt="git" data-proofer-ignore></p><p>The last commit has the description of <strong>“fix info leak”</strong>, That’s why we didn’t find the password, let’s now check the second commit which will likely be the one where readme file contained the password. We can do that by executing <code class="language-plaintext highlighter-rouge">git show {hash}</code>.</p><p><img data-src="/assets/img/overthewire/bandit/gitpass.png" alt="git" data-proofer-ignore></p><p>The password for the next level : bbc96594b4e001778eee9975372716b2</p><h1 id="level-29---level-30"><strong>Level 29 -&gt; Level 30</strong></h1><h2 id="goal-4"><span class="mr-2">Goal</span><a href="#goal-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a git repository at ssh://bandit29-git@localhost/home/bandit29-git/repo. The password for the user bandit29-git is the same as for the user bandit29.</p><p>Clone the repository and find the password for the next level.</p><h2 id="solution-4"><span class="mr-2">Solution</span><a href="#solution-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s clone the repository and investigate it. README file doesn’t have the password as expected, let’s see the logs.</p><p><img data-src="/assets/img/overthewire/bandit/twologs.png" alt="logs" data-proofer-ignore></p><p>Checking the first commit, we don’t see any password. Let’s run <code class="language-plaintext highlighter-rouge">git logs --all</code> to see if there is any other commit we couldn’t see before.</p><p><img data-src="/assets/img/overthewire/bandit/logsall.png" alt="all" data-proofer-ignore></p><p>Indeed there are other commits. Let’s check the changes of each commit.</p><p><img data-src="/assets/img/overthewire/bandit/datapass.png" alt="gg" data-proofer-ignore></p><p>The <em>–oneline</em> option used in the image above shows only a small part of the hash and the description for better view, and we can use the short version of the hash with git show to see the changes.</p><p>The password for the next level : 5b90576bedb2cc04c86a9e924ce42faf</p><h1 id="level-30---level-31"><strong>Level 30 -&gt; Level 31</strong></h1><h2 id="goal-5"><span class="mr-2">Goal</span><a href="#goal-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a git repository at ssh://bandit30-git@localhost/home/bandit30-git/repo. The password for the user bandit30-git is the same as for the user bandit30.</p><p>Clone the repository and find the password for the next level.</p><h2 id="solution-5"><span class="mr-2">Solution</span><a href="#solution-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s clone the repository and check the logs.</p><p><img data-src="/assets/img/overthewire/bandit/l.png" alt="l" data-proofer-ignore></p><p>We only see one commit. Let’s check if there is any tags using <code class="language-plaintext highlighter-rouge">git tag</code>.</p><p><img data-src="/assets/img/overthewire/bandit/tag.png" alt="l" data-proofer-ignore></p><p>Tags are ref’s that point to specific points in Git history, and it is usually used to capture a point in history that is used for marked version release. In our case, we found <strong>secret</strong> tag, let’s show it using <code class="language-plaintext highlighter-rouge">git show secret</code></p><p><img data-src="/assets/img/overthewire/bandit/secret.png" alt="l" data-proofer-ignore></p><p>The password for the next level : 47e603bb428404d265f59c42920d81e5</p><h1 id="level-31---level-32"><strong>Level 31 -&gt; Level 32</strong></h1><h2 id="goal-6"><span class="mr-2">Goal</span><a href="#goal-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a git repository at ssh://bandit31-git@localhost/home/bandit31-git/repo. The password for the user bandit31-git is the same as for the user bandit31.</p><p>Clone the repository and find the password for the next level.</p><h2 id="solution-6"><span class="mr-2">Solution</span><a href="#solution-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As always, let’s clone the repository and see what’s there.</p><p><img data-src="/assets/img/overthewire/bandit/pushre.png" alt="l" data-proofer-ignore></p><p>It seems that we need to create a file called <em>key.txt</em> that contains ‘May I come in?’ in it and push that file to the remote repository, so let’s create the file and push it.</p><p><img data-src="/assets/img/overthewire/bandit/creat.png" alt="l" data-proofer-ignore></p><p>We couldn’t upload the file because there is a <strong>.gitignore</strong> file, which is a file that specifies intentionally untracked files that Git should ignore. Inside of the file there is <strong>.txt</strong>, which means it will ignore every .txt file.</p><p><img data-src="/assets/img/overthewire/bandit/ignore.png" alt="l" data-proofer-ignore></p><p>Let’s modify the file by removing <strong>*.txt</strong>, push it after that.</p><p><img data-src="/assets/img/overthewire/bandit/upload.png" alt="l" data-proofer-ignore></p><p>We have successfully pushed the file and got the password.</p><p>The password for the next level : 56a9bf19c63d650ce78e6ec0354ee45e</p><h1 id="level-32---level-33"><strong>Level 32 -&gt; Level 33</strong></h1><h2 id="goal-7"><span class="mr-2">Goal</span><a href="#goal-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After all this git stuff its time for another escape. Good luck!</p><h2 id="solution-7"><span class="mr-2">Solution</span><a href="#solution-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we login, we get a unusual prompt, and we can’t execute linux commands</p><p><img data-src="/assets/img/overthewire/bandit/weard.png" alt="l" data-proofer-ignore></p><p>The shell seems to convert every command we enter into uppercase. Let’s go back the bandit 31 and check what shell bandit32 use.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">bandit31@bandit:~$</span><span class="w"> </span><span class="nb">cat</span> /etc/passwd | <span class="nb">grep </span>bandit32
<span class="go">bandit32:x:11032:11032:bandit level 32:/home/bandit32:/home/bandit32/uppershell
</span></pre></table></code></div></div><p>It uses a shell called <code class="language-plaintext highlighter-rouge">uppershell</code>.</p><p>Let’s try tho understand how this shell works.</p><p>When we run a command, let’s say for example <code class="language-plaintext highlighter-rouge">whoami</code>, we get the following:</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">&gt;</span><span class="o">&gt;</span> <span class="nb">whoami</span>
<span class="go">sh: 1: WHOAMI: not found
</span></pre></table></code></div></div><p>We can see <code class="language-plaintext highlighter-rouge">sh</code>, which is what the program uses to execute commands, and after it we see a <code class="language-plaintext highlighter-rouge">1</code> and <code class="language-plaintext highlighter-rouge">WHOAMI</code>. We conclude from that error message that the program uses positional parameter to do it’s job. Read more about positional parameter in this <a href="https://bash.cyberciti.biz/guide/How_to_use_positional_parameters">article</a></p><p>What we need to do to get a shell is to invoke the first positional parameter - that happens to be <code class="language-plaintext highlighter-rouge">sh</code>- by typing the parameter for <code class="language-plaintext highlighter-rouge">sh</code> which is going to be <code class="language-plaintext highlighter-rouge">$0</code></p><p><img data-src="/assets/img/overthewire/bandit/parameter.png" alt="l" data-proofer-ignore></p><p>By executing <code class="language-plaintext highlighter-rouge">$0</code> we get an <strong>sh</strong> shell, we can get an appropriate shell by exporting the value of $SHELL to /bin/bash and calling it after that.</p><hr /><p>We have finally finished the all the 33 levels of Bandit, so kudos for making it here, thank you for taking the time to read my writeup, hopefully you have learnt some new tricks along the way. If you have any questions or comments, please feel free to reach out to me. See you in the next hack :) .</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/overthewire/'>OverTheWire</a>, <a href='/categories/bandit/'>Bandit</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/overthewire/" class="post-tag no-text-decoration" >overthewire</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/bandit/" class="post-tag no-text-decoration" >bandit</a> <a href="/tags/git/" class="post-tag no-text-decoration" >git</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OverTheWire+-+Bandit+-+Level+25+-%3E+Level+33+-+Nasrallah&url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-25-33%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OverTheWire+-+Bandit+-+Level+25+-%3E+Level+33+-+Nasrallah&u=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-25-33%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-25-33%2F&text=OverTheWire+-+Bandit+-+Level+25+-%3E+Level+33+-+Nasrallah" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-25-33%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Preignition/">HackTheBox - Preignition</a><li><a href="/posts/HTB-Appointment/">HackTheBox - Appointment</a><li><a href="/posts/HTB-Sequel/">HackTheBox - Sequel</a><li><a href="/posts/HTB-Responder/">HackTheBox - Responder</a><li><a href="/posts/blunder/">HackTheBox - Blunder</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/hackthissite/">hackthissite</a> <a class="post-tag" href="/tags/hts/">hts</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/html/">html</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Bandit-0-5/"><div class="card-body"> <em class="small" data-ts="1644019200" data-df="ll" > Feb 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 0 -> Level 5</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. We are going to start Bandit series from OverTheWire. The Bandit wargame is aimed at absolute beginners. It will teach the basics needed to be...</p></div></div></a></div><div class="card"> <a href="/posts/Bandit-5-10/"><div class="card-body"> <em class="small" data-ts="1644192000" data-df="ll" > Feb 7, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 5 -> Level 10</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. In today’s episode we will be doing Level 5 -&amp;gt; Level 10 of Bandit from OverTheWire. Let’s connect to bandit5 and start. Level 5 -&amp;gt; Leve...</p></div></div></a></div><div class="card"> <a href="/posts/Bandit-10-15/"><div class="card-body"> <em class="small" data-ts="1644364800" data-df="ll" > Feb 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 10 -> Level 15</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. In today’s episode, we will be doing Level 10 -&amp;gt; Level 15 of Bandit from OverTheWire. Let’s connect to bandit10 and start. Level 10 -&amp;gt; ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bandit-20-25/" class="btn btn-outline-primary" prompt="Older"><p>OverTheWire - Bandit - Level 20 -> Level 25</p></a> <a href="/posts/blunder/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Blunder</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/NasrallahBaadi">NasrallahBaadi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/hackthissite/">hackthissite</a> <a class="post-tag" href="/tags/hts/">hts</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/html/">html</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
