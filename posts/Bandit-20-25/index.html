<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OverTheWire - Bandit - Level 20 -&gt; Level 25" /><meta name="author" content="Nasrallah" /><meta property="og:locale" content="en" /><meta name="description" content="Learning journey." /><meta property="og:description" content="Learning journey." /><link rel="canonical" href="https://nasrallahbaadi.github.io/posts/Bandit-20-25/" /><meta property="og:url" content="https://nasrallahbaadi.github.io/posts/Bandit-20-25/" /><meta property="og:site_name" content="Nasrallah" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-13T01:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OverTheWire - Bandit - Level 20 -&gt; Level 25" /><meta name="twitter:site" content="@NasrallahBaadi" /><meta name="twitter:creator" content="@Nasrallah" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Nasrallah"},"dateModified":"2022-07-08T17:56:10+01:00","datePublished":"2022-02-13T01:00:00+01:00","description":"Learning journey.","headline":"OverTheWire - Bandit - Level 20 -&gt; Level 25","mainEntityOfPage":{"@type":"WebPage","@id":"https://nasrallahbaadi.github.io/posts/Bandit-20-25/"},"url":"https://nasrallahbaadi.github.io/posts/Bandit-20-25/"}</script><title>OverTheWire - Bandit - Level 20 -> Level 25 | Nasrallah</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nasrallah"><meta name="application-name" content="Nasrallah"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nasrallah</a></div><div class="site-subtitle font-italic">Learning journey</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/NasrallahBaadi" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/NasrallahBaadi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/NasrallahBaadi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/565048" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Nasrallah" aria-label="TryHackMe" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://t.me/Sirius1337" aria-label="Telegram" target="_blank" rel="noopener"> <i class="fab fa-telegram"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['baadinasrallah','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OverTheWire - Bandit - Level 20 -> Level 25</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>OverTheWire - Bandit - Level 20 -> Level 25</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1644710400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 13, 2022 </em> </span> <span> Updated <em class="" data-ts="1657299370" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 8, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> NasrallahBaadi </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1509 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><hr /><h1 id="description"><strong>Description</strong></h1><p>Hello l33ts, I hope you are doing well. In today’s episode, we will be doing Level 20 -&gt; Level 25 of <a href="https://overthewire.org/wargames/bandit/">Bandit</a> from <a href="https://overthewire.org/wargames/">OverTheWire</a>. Let’s connect to <strong>bandit20</strong> and start.</p><h1 id="level-20---level-21"><strong>Level 20 -&gt; Level 21</strong></h1><h2 id="goal"><span class="mr-2">Goal</span><a href="#goal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p><p>NOTE: Try connecting to your own network daemon to see if it works as you think</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Since we need to connect to a localhost port, i used <code class="language-plaintext highlighter-rouge">nmap</code> to scan all port in localhost, but nothing stands out. I fired up another ssh connection to bandit20 and did the following.</p><p><img data-src="/assets/img/overthewire/bandit/bandit20.png" alt="bandit20" data-proofer-ignore></p><p>Let’s break this down.</p><p>On the right, set up a netcat listener on port 9000 that echo’s the password when we connect to it. On the left i used the binary to connect to our netcat listener on the same port. And with that, we succeed to get the password for next level <code class="language-plaintext highlighter-rouge">gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</code>.</p><h1 id="level-21---level-22"><strong>Level 21 -&gt; Level 22</strong></h1><h2 id="goal-1"><span class="mr-2">Goal</span><a href="#goal-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.</p><h2 id="solution-1"><span class="mr-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s navigate to <strong>/etc/cron.d</strong> directory and see what’s there.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">bandit21@bandit:~$</span><span class="w"> </span><span class="nb">cd</span> /etc/cron.d
<span class="gp">bandit21@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">cronjob_bandit15_root  cronjob_bandit17_root  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  cronjob_bandit25_root
</span><span class="gp">bandit21@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">cat </span>cronjob_bandit22
<span class="gp">@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt;</span><span class="w"> </span>/dev/null
<span class="gp">* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt;</span><span class="w"> </span>/dev/null
<span class="gp">bandit21@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">cat</span> /usr/bin/cronjob_bandit22.sh
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span><span class="gp">cat /etc/bandit_pass/bandit22 &gt;</span><span class="w"> </span>/tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</pre></table></code></div></div><p>We found a bunch of scripts, but the one we’re interested in called <strong>cronjob_bandit22</strong> and it executes a script located in /usr/bin directory. Looking at the content of the script file we see that it writes the password of <strong>bandit22</strong> into a file in <strong>/tmp</strong> directory, we can print the content of that file and get the password.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">bandit21@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">cat</span> /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
<span class="go">Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
</span></pre></table></code></div></div><h1 id="level-22---level-23"><strong>Level 22 -&gt; Level 23</strong></h1><h2 id="goal-2"><span class="mr-2">Goal</span><a href="#goal-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.</p><p>NOTE: Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. If you are having problems understanding what it does, try executing it to see the debug information it prints.</p><h2 id="solution-2"><span class="mr-2">Solution</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As we did in the last level, we print the bandit23 cron job file and it tells us the file that being executed automatically, if we print the content of that file we see the following.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">bandit22@bandit:~$</span><span class="w"> </span><span class="nb">cat</span> /usr/bin/cronjob_bandit23.sh
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">
</span><span class="gp">myname=$</span><span class="o">(</span><span class="nb">whoami</span><span class="o">)</span>
<span class="gp">mytarget=$</span><span class="o">(</span><span class="nb">echo </span>I am user <span class="nv">$myname</span> | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1<span class="o">)</span>
<span class="go">
</span><span class="gp">echo "Copying passwordfile /etc/bandit_pass/$</span>myname to /tmp/<span class="nv">$mytarget</span><span class="s2">"
</span><span class="go">
</span><span class="gp">cat /etc/bandit_pass/$</span>myname <span class="o">&gt;</span> /tmp/<span class="nv">$mytarget</span>
</pre></table></code></div></div><ul><li>The first line of the script (<strong>#!/bin/bash</strong>) is called a Shebang, and is used to tell the operating system which interpreter to use to parse the rest of the file, in our case it’s bash.<li>The second command (<strong>myname=$(whoami)</strong>), is executing the command <code class="language-plaintext highlighter-rouge">whoami</code> and save the output to a variable called <em>myname</em><li>The third command is what really interest us, what it does is it echos <strong>I am user $myname</strong>, hash it using <code class="language-plaintext highlighter-rouge">md5sum</code>, and removes any spaces left in the output, and uses the string left to name a file where it saves the password, so we can replace <strong>$myname</strong> with <strong>bandit23</strong> and get the name of the file.</ul><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">bandit22@bandit:~$</span><span class="w"> </span><span class="nb">cd</span> /etc/cron.d
<span class="gp">bandit22@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">cronjob_bandit15_root  cronjob_bandit17_root  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  cronjob_bandit25_root
</span><span class="gp">bandit22@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">cat </span>cronjob_bandit23
<span class="gp">@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt;</span><span class="w"> </span>/dev/null
<span class="gp">* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt;</span><span class="w"> </span>/dev/null
<span class="gp">bandit22@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">cat</span> /usr/bin/cronjob_bandit23.sh
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">
</span><span class="gp">myname=$</span><span class="o">(</span><span class="nb">whoami</span><span class="o">)</span>
<span class="gp">mytarget=$</span><span class="o">(</span><span class="nb">echo </span>I am user <span class="nv">$myname</span> | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1<span class="o">)</span>
<span class="go">
</span><span class="gp">echo "Copying passwordfile /etc/bandit_pass/$</span>myname to /tmp/<span class="nv">$mytarget</span><span class="s2">"
</span><span class="go">
</span><span class="gp">cat /etc/bandit_pass/$</span>myname <span class="o">&gt;</span> /tmp/<span class="nv">$mytarget</span>
<span class="gp">bandit22@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">echo </span>I am user bandit23 | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1
<span class="go">8ca319486bfbbc3663ea0fbe81326349
</span><span class="gp">bandit22@bandit:/etc/cron.d$</span><span class="w"> </span><span class="nb">cat</span> /tmp/8ca319486bfbbc3663ea0fbe81326349
<span class="go">jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
</span><span class="gp">bandit22@bandit:/etc/cron.d$</span><span class="w">
</span></pre></table></code></div></div><h1 id="level-23---level-24"><strong>Level 23 -&gt; Level 24</strong></h1><h2 id="goal-3"><span class="mr-2">Goal</span><a href="#goal-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.</p><p>NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level!</p><p>NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy around…</p><h2 id="solution-3"><span class="mr-2">Solution</span><a href="#solution-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We print the content of the file we saw being executed reguraly in /etc/cron.d/cronjob_bandit24.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="gp">bandit23@bandit:~$</span><span class="w"> </span><span class="nb">cat</span> /etc/cron.d/cronjob_bandit24
<span class="gp">@reboot bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt;</span><span class="w"> </span>/dev/null
<span class="gp">* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt;</span><span class="w"> </span>/dev/null
<span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">cat</span> /usr/bin/cronjob_bandit24.sh
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">
</span><span class="gp">myname=$</span><span class="o">(</span><span class="nb">whoami</span><span class="o">)</span>
<span class="go">
</span><span class="gp">cd /var/spool/$</span>myname
<span class="gp">echo "Executing and deleting all scripts in /var/spool/$</span>myname:<span class="s2">"
</span><span class="gp">for i in * .*;</span><span class="w">
</span><span class="go">do
</span><span class="gp">    if [ "$</span>i<span class="s2">" != "</span>.<span class="s2">" -a "</span><span class="nv">$i</span><span class="s2">" != "</span>..<span class="s2">" ];
</span><span class="go">    then
</span><span class="gp">        echo "Handling $</span>i<span class="s2">"
</span><span class="gp">        owner="$</span><span class="s2">(stat --format "</span>%U<span class="s2">" ./</span><span class="nv">$i</span><span class="s2">)"</span>
<span class="gp">        if [ "$</span><span class="o">{</span>owner<span class="o">}</span><span class="s2">" = "</span>bandit23<span class="s2">" ]; then
</span><span class="gp">            timeout -s 9 60 ./$</span><span class="s2">i
</span><span class="go">        fi
</span><span class="gp">        rm -f ./$</span>i
<span class="go">    fi
done
</span></pre></table></code></div></div><p>So what the script does is change directory to <strong>/var/spool/$myname</strong> and the <em>$myname</em> variable being <strong>bandit24</strong>, it then executes every hidden file located in that directory, and then deletes it all the hidden files after that. What we need to do is create a script that gives us <strong>bandit24</strong>’s password, save the script as a hidden file in <em>/var/spool/bandit24</em> and wait for our script to get executed.</p><p>The i solved this challenge was by first creating a directory in <strong>/tmp</strong>, and give that directory full permissions so bandit24 can write there.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">bandit23@bandit:~$</span><span class="w"> </span><span class="nb">mkdir</span> /tmp/dir
<span class="gp">bandit23@bandit:~$</span><span class="w"> </span><span class="nb">chmod </span>777 /tmp/dir
<span class="gp">bandit23@bandit:~$</span><span class="w"> </span><span class="nb">cd</span> /tmp/dir
<span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w">
</span></pre></table></code></div></div><p>After that i proceeded to write the script, i first created a hidden file and write the command that are going to be executed.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">touch</span> .script.sh
<span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">echo</span> <span class="s1">'#!/bin/bash'</span> <span class="o">&gt;</span> .script.sh
<span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">echo</span> <span class="s1">'cat /etc/bandit_pass/bandit24 &gt; /tmp/dir/bandit24'</span> <span class="o">&gt;&gt;</span> .script.sh
<span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">chmod</span> +x .script.sh
<span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">cat</span> .script.sh
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="gp">cat /etc/bandit_pass/bandit24 &gt;</span><span class="w"> </span>/tmp/dir/bandit24
<span class="go">
</span><span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">cp</span> .script.sh /var/spool/bandit24/
</pre></table></code></div></div><p>In my case, i choose to write a simple bash script that reads the <em>/etc/bandit_pass/bandit24</em> and saves the output to a file called <em>bandit24** in the /tmp/dir we created earlier. I gave the file execution permission and copied it to */var/spool/bandit24</em> directory. We wait a bit and we should see our file bandit24 that contains the password in /tmp/dir directory.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">bandit24
</span><span class="gp">bandit23@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">cat </span>bandit24
<span class="go">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
</span></pre></table></code></div></div><h1 id="level-24---level-25"><strong>Level 24 -&gt; Level 25</strong></h1><h2 id="goal-4"><span class="mr-2">Goal</span><a href="#goal-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing.</p><h2 id="solution-4"><span class="mr-2">Solution</span><a href="#solution-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So we need to generate a list of possible combinations, save them is a file and use that list to brute force the pincode.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>0000..9999<span class="o">}</span><span class="p">;</span> <span class="k">do
    </span><span class="nb">echo</span> <span class="s2">"UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ"</span> <span class="nv">$i</span> <span class="o">&gt;&gt;</span> list
<span class="k">done</span>
</pre></table></code></div></div><p>That’s the script i will use to generate the list. I put that in a file and gave that file execution permissions so i can run it.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">cat </span>script.sh
<span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">
</span><span class="gp">for i in {0000..9999};</span><span class="w"> </span><span class="k">do</span>
<span class="gp">    echo "UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ" $</span>i <span class="o">&gt;&gt;</span> list
<span class="go">done
</span><span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">chmod</span> +x script.sh
<span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w"> </span>./script.sh
<span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">list  script.sh
</span></pre></table></code></div></div><p>Now if we check the list we generated, we’ll see the following.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">head </span>list
<span class="go">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0000
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0001
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0002
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0003
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0004
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0005
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0006
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0007
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0008
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0009
</span></pre></table></code></div></div><p>We succeeded in creating a list, now let’s use that list to brute force the pincode.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w"> </span><span class="nb">cat </span>list | nc localhost 30002
<span class="go">I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.       
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
</span><span class="c">.
.
</span><span class="go">Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
Correct!
The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG

Exiting.
</span><span class="gp">bandit24@bandit:/tmp/dir$</span><span class="w">
</span></pre></table></code></div></div><hr /><p>Thank you for taking the time to read my writeup, I hope you have learned something with this, if you have any questions or comments, please feel free to reach out to me. See you in the next hack :) .</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/overthewire/'>OverTheWire</a>, <a href='/categories/bandit/'>Bandit</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/overthewire/" class="post-tag no-text-decoration" >overthewire</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/bandit/" class="post-tag no-text-decoration" >bandit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OverTheWire+-+Bandit+-+Level+20+-%3E+Level+25+-+Nasrallah&url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-20-25%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OverTheWire+-+Bandit+-+Level+20+-%3E+Level+25+-+Nasrallah&u=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-20-25%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-20-25%2F&text=OverTheWire+-+Bandit+-+Level+20+-%3E+Level+25+-+Nasrallah" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-20-25%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Preignition/">HackTheBox - Preignition</a><li><a href="/posts/HTB-Appointment/">HackTheBox - Appointment</a><li><a href="/posts/HTB-Sequel/">HackTheBox - Sequel</a><li><a href="/posts/HTB-Responder/">HackTheBox - Responder</a><li><a href="/posts/blunder/">HackTheBox - Blunder</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/hackthissite/">hackthissite</a> <a class="post-tag" href="/tags/hts/">hts</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/html/">html</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Bandit-0-5/"><div class="card-body"> <em class="small" data-ts="1644019200" data-df="ll" > Feb 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 0 -> Level 5</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. We are going to start Bandit series from OverTheWire. The Bandit wargame is aimed at absolute beginners. It will teach the basics needed to be...</p></div></div></a></div><div class="card"> <a href="/posts/Bandit-5-10/"><div class="card-body"> <em class="small" data-ts="1644192000" data-df="ll" > Feb 7, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 5 -> Level 10</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. In today’s episode we will be doing Level 5 -&amp;gt; Level 10 of Bandit from OverTheWire. Let’s connect to bandit5 and start. Level 5 -&amp;gt; Leve...</p></div></div></a></div><div class="card"> <a href="/posts/Bandit-10-15/"><div class="card-body"> <em class="small" data-ts="1644364800" data-df="ll" > Feb 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 10 -> Level 15</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. In today’s episode, we will be doing Level 10 -&amp;gt; Level 15 of Bandit from OverTheWire. Let’s connect to bandit10 and start. Level 10 -&amp;gt; ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bandit-15-20/" class="btn btn-outline-primary" prompt="Older"><p>OverTheWire - Bandit - Level 15 -> Level 20</p></a> <a href="/posts/Bandit-25-33/" class="btn btn-outline-primary" prompt="Newer"><p>OverTheWire - Bandit - Level 25 -> Level 33</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/NasrallahBaadi">NasrallahBaadi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/hackthissite/">hackthissite</a> <a class="post-tag" href="/tags/hts/">hts</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/html/">html</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
