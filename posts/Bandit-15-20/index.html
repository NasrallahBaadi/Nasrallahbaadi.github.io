<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OverTheWire - Bandit - Level 15 -&gt; Level 20" /><meta name="author" content="Nasrallah" /><meta property="og:locale" content="en" /><meta name="description" content="Learning journey." /><meta property="og:description" content="Learning journey." /><link rel="canonical" href="https://nasrallahbaadi.github.io/posts/Bandit-15-20/" /><meta property="og:url" content="https://nasrallahbaadi.github.io/posts/Bandit-15-20/" /><meta property="og:site_name" content="Nasrallah" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-11T01:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OverTheWire - Bandit - Level 15 -&gt; Level 20" /><meta name="twitter:site" content="@NasrallahBaadi" /><meta name="twitter:creator" content="@Nasrallah" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Nasrallah"},"dateModified":"2022-07-08T17:56:10+01:00","datePublished":"2022-02-11T01:00:00+01:00","description":"Learning journey.","headline":"OverTheWire - Bandit - Level 15 -&gt; Level 20","mainEntityOfPage":{"@type":"WebPage","@id":"https://nasrallahbaadi.github.io/posts/Bandit-15-20/"},"url":"https://nasrallahbaadi.github.io/posts/Bandit-15-20/"}</script><title>OverTheWire - Bandit - Level 15 -> Level 20 | Nasrallah</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nasrallah"><meta name="application-name" content="Nasrallah"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nasrallah</a></div><div class="site-subtitle font-italic">Learning journey</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/NasrallahBaadi" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/NasrallahBaadi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/NasrallahBaadi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/565048" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Nasrallah" aria-label="TryHackMe" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://t.me/Sirius1337" aria-label="Telegram" target="_blank" rel="noopener"> <i class="fab fa-telegram"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['baadinasrallah','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OverTheWire - Bandit - Level 15 -> Level 20</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>OverTheWire - Bandit - Level 15 -> Level 20</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1644537600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 11, 2022 </em> </span> <span> Updated <em class="" data-ts="1657299370" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 8, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> NasrallahBaadi </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1431 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><hr /><h1 id="description"><strong>Description</strong></h1><p>Hello l33ts, I hope you are doing well. In today’s episode, we will be doing Level 15 -&gt; Level 20 of <a href="https://overthewire.org/wargames/bandit/">Bandit</a> from <a href="https://overthewire.org/wargames/">OverTheWire</a>. Let’s connect to <strong>bandit15</strong> and start.</p><h1 id="level-15---level-16"><strong>Level 15 -&gt; Level 16</strong></h1><h2 id="goal"><span class="mr-2">Goal</span><a href="#goal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The password for the next level can be retrieved by submitting the password of the current level to port 30001 on localhost using SSL encryption.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We need to connect to localhost on the specified port using SSL encryption, so telnet will not work because is sends everything unencrypted.<br /> One of the commands we can use is <code class="language-plaintext highlighter-rouge">openssl</code> with subcommand <code class="language-plaintext highlighter-rouge">s_client</code>. If we read the description in the man page of this command it says: <strong>The s_client command implements a generic SSL/TLS client which connects to a remote host using SSL/TLS.</strong> That’s great, so we can use this command to connect to a host using SSH encryption. We need to specify some option first.</p><ul><li><strong>-quiet</strong> : This option inhibits printing of session and certificate information, cause our goal is to only to submit the password.<li><strong>-connect</strong> : This option specifies the host and optional port to connect to.</ul><p>Now our final command looks like this:<code class="language-plaintext highlighter-rouge">openssl s_client -quiet -connect localhost:30001</code></p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">bandit15@bandit:~$</span><span class="w"> </span>openssl s_client <span class="nt">-quiet</span> <span class="nt">-connect</span> localhost:30001
<span class="go">depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1
BfMYroe26WYalil77FoDi9qh59eK5xNr
Correct!
cluFn7wTiGryunymYOu4RcffSxQluehd
</span></pre></table></code></div></div><h1 id="level-16---level-17"><strong>Level 16 -&gt; Level 17</strong></h1><h2 id="goal-1"><span class="mr-2">Goal</span><a href="#goal-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range 31000 to 32000. First find out which of these ports have a server listening on them. Then find out which of those speak SSL and which don’t. There is only 1 server that will give the next credentials, the others will simply send back to you whatever you send to it.</p><h2 id="solution-1"><span class="mr-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I first run <code class="language-plaintext highlighter-rouge">netstat</code> to see listening ports but it didn’t work. Next, i checked if nmap is installed and BINGO, it is. Running a scan with specifying port 31000 to 32000 gives the following.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="gp">bandit16@bandit:~$</span><span class="w"> </span>which nmap
<span class="go">/usr/bin/nmap
</span><span class="gp">bandit16@bandit:~$</span><span class="w"> </span>nmap <span class="nt">-p31000-32000</span> localhost
<span class="go">
Starting Nmap 7.40 ( https://nmap.org ) at 2022-02-18 18:20 CET
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00026s latency).
Not shown: 996 closed ports
PORT      STATE SERVICE
31046/tcp open  unknown
31518/tcp open  unknown
31691/tcp open  unknown
31790/tcp open  unknown
31960/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 0.11 seconds
</span><span class="gp">bandit16@bandit:~$</span><span class="w"> </span>nmap <span class="nt">-sV</span> <span class="nt">-p31000-32000</span> localhost
</pre></table></code></div></div><p>Not really helpful, Let’s run a service scan with <strong>-sV</strong> option.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="gp">bandit16@bandit:~$</span><span class="w"> </span>nmap <span class="nt">-sV</span> <span class="nt">-p31000-32000</span> localhost
<span class="go">
Starting Nmap 7.40 ( https://nmap.org ) at 2022-02-18 18:20 CET
</span><span class="gp">Stats: 0:00:26 elapsed;</span><span class="w"> </span>0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing Service Scan
<span class="go">Service scan Timing: About 0.00% done
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00023s latency).
Not shown: 996 closed ports
PORT      STATE SERVICE     VERSION
31046/tcp open  echo
31518/tcp open  ssl/echo
31691/tcp open  echo
31790/tcp open  ssl/unknown
31960/tcp open  echo
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port31790-TCP:V=7.40%T=SSL%I=7%D=2/18%Time=620FD570%P=x86_64-pc-linux-g
SF:nu%r(GenericLines,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20cu
SF:rrent\x20password\n")%r(GetRequest,31,"Wrong!\x20Please\x20enter\x20the
SF:\x20correct\x20current\x20password\n")%r(HTTPOptions,31,"Wrong!\x20Plea
SF:se\x20enter\x20the\x20correct\x20current\x20password\n")%r(RTSPRequest,
SF:31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\
SF:n")%r(Help,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
SF:20password\n")%r(SSLSessionReq,31,"Wrong!\x20Please\x20enter\x20the\x20
SF:correct\x20current\x20password\n")%r(TLSSessionReq,31,"Wrong!\x20Please
SF:\x20enter\x20the\x20correct\x20current\x20password\n")%r(Kerberos,31,"W
SF:rong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n")%r
SF:(FourOhFourRequest,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20c
SF:urrent\x20password\n")%r(LPDString,31,"Wrong!\x20Please\x20enter\x20the
SF:\x20correct\x20current\x20password\n")%r(LDAPSearchReq,31,"Wrong!\x20Pl
SF:ease\x20enter\x20the\x20correct\x20current\x20password\n")%r(SIPOptions
SF:,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password
</span><span class="gp">SF:\n");</span><span class="w">
</span><span class="go">
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 88.60 seconds
</span></pre></table></code></div></div><p>Great, we got our port. The ports that has <strong>echo</strong> as a service are the one that sends back whatever we give them, the only port that doesn’t and has SSH encryption is <strong>31790</strong></p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="gp">bandit16@bandit:~$</span><span class="w"> </span>openssl s_client <span class="nt">-quiet</span> <span class="nt">-connect</span> localhost:31790
<span class="go">depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1
cluFn7wTiGryunymYOu4RcffSxQluehd
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----

</span><span class="gp">bandit16@bandit:~$</span><span class="w">
</span></pre></table></code></div></div><p>Great, it worked, and we got a private ssh key, let’s copy it and put it in a file on our machine, give it the right permission and connect to bandit17 with it.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="go">┌──(sirius㉿kali)-[~]                                                         
</span><span class="gp">└─$</span><span class="w"> </span>vim id_rsa                                                                
<span class="go">
┌──(sirius㉿kali)-[~]                                                         
</span><span class="gp">└─$</span><span class="w"> </span><span class="nb">chmod </span>600 id_rsa                                                          
<span class="go">
┌──(sirius㉿kali)-[~]                                                         
</span><span class="gp">└─$</span><span class="w"> </span>ssh <span class="nt">-i</span> id_rsa bandit17@bandit.labs.overthewire.org <span class="nt">-p</span> 2220                 
<span class="go">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

Linux bandit.otw.local 5.4.8 x86_64 GNU/Linux

      ,----..            ,----,          .---.
     /   /   \         ,/   .`|         /. ./|                    
</span><span class="gp">    /   .     :      ,`   .'  :     .--'.  ' ;</span><span class="w">
</span><span class="gp">   .   /   ;</span><span class="nb">.</span>  <span class="se">\ </span>  <span class="p">;</span>    <span class="p">;</span>     /    /__./ <span class="se">\ </span>: |
<span class="gp">  .   ;</span><span class="w">   </span>/  <span class="sb">`</span> <span class="p">;</span> .<span class="s1">'___,/    ,'</span> .--<span class="s1">'.  '</span>   <span class="se">\'</span> <span class="nb">.</span>                                                                                                               
<span class="gp">  ;</span><span class="w">   </span>|  <span class="p">;</span> <span class="se">\ </span><span class="p">;</span> | |    :     | /___/ <span class="se">\ </span>|    <span class="s1">' '</span>
<span class="gp">  |   :  | ;</span><span class="w"> </span>| <span class="s1">' ;    |.'</span><span class="p">;</span>  <span class="p">;</span> <span class="p">;</span>   <span class="se">\ </span> <span class="se">\;</span>      :
<span class="gp">  .   |  ' ' ' : `----'  |  |  \   ;</span><span class="w">  </span><span class="sb">`</span>      |                                
<span class="gp">  '   ;</span><span class="w">  </span><span class="se">\;</span> /  |     <span class="s1">'   :  ;   .   \    .\  ;                                
</span><span class="go">   \   \  ',  /      |   |  '    \   \   ' \ |                     
</span><span class="gp">    ;</span><span class="w">   </span>:    /       <span class="s1">'   :  |     :   '</span>  |--<span class="s2">"                            
</span><span class="gp">     \   \ .'        ;</span><span class="w">   </span><span class="s2">|.'       </span><span class="se">\ </span><span class="s2">  </span><span class="se">\ </span><span class="s2">;                       
</span><span class="go">  www. `---` ver     '---' he       '---" ire.org


Welcome to OverTheWire!
For support, questions or comments, contact us through IRC on
</span><span class="gp">irc.overthewire.org #</span>wargames.
<span class="go">
Enjoy your stay!

</span><span class="gp">bandit17@bandit:~$</span><span class="w">
</span></pre></table></code></div></div><h1 id="level-17---level-18"><strong>Level 17 -&gt; Level 18</strong></h1><h2 id="goal-2"><span class="mr-2">Goal</span><a href="#goal-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There are 2 files in the homedirectory: passwords.old and passwords.new. The password for the next level is in passwords.new and is the only line that has been changed between passwords.old and passwords.new</p><p>NOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19</p><h2 id="solution-2"><span class="mr-2">Solution</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="my-method"><span class="mr-2">My method</span><a href="#my-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The way i first solved this challenge was by printing the two files, sorting the output and used <code class="language-plaintext highlighter-rouge">uniq</code> to be left with the two strings that got changed, and one of them is the password.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">bandit17@bandit:~$</span><span class="w"> </span><span class="nb">cat </span>passwords.<span class="k">*</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-u</span>
<span class="go">kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
w0Yfolrc5bwjS4qw5mq1nnQi6mF03bii
</span></pre></table></code></div></div><h3 id="other-method"><span class="mr-2">Other method</span><a href="#other-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can simply use <code class="language-plaintext highlighter-rouge">diff</code> to compare the files line by line.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">bandit17@bandit:~$</span><span class="w"> </span>diff passwords.new passwords.old
<span class="go">42c42
&lt; kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
---
</span><span class="gp">&gt;</span><span class="w"> </span>w0Yfolrc5bwjS4qw5mq1nnQi6mF03bii
</pre></table></code></div></div><h1 id="level-18---level-19"><strong>Level 18 -&gt; Level 19</strong></h1><h2 id="goal-3"><span class="mr-2">Goal</span><a href="#goal-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH.</p><h2 id="solution-3"><span class="mr-2">Solution</span><a href="#solution-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This one mad me lose my mind. Every time we connect to bandit18 we get the following.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">Byebye !
Connection to bandit.labs.overthewire.org closed.
</span></pre></table></code></div></div><p>As described in the Goal, we get logged out everytime we log in with ssh, so we can try to execute a command that prints readme file without waiting to get a shell.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">┌──(sirius㉿kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span>ssh bandit18@bandit.labs.overthewire.org <span class="nt">-p</span> 2220 <span class="nb">cat </span>readme   
<span class="go">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password:
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x
</span></pre></table></code></div></div><h1 id="level-19---level-20"><strong>Level 19 -&gt; Level 20</strong></h1><h2 id="goal-4"><span class="mr-2">Goal</span><a href="#goal-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To gain access to the next level, you should use the setuid binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (/etc/bandit_pass), after you have used the setuid binary.</p><h2 id="solution-4"><span class="mr-2">Solution</span><a href="#solution-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s first see what the command does.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">bandit19@bandit:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span>
<span class="go">total 8
-rwsr-x--- 1 bandit20 bandit19 7296 May  7  2020 bandit20-do
</span><span class="gp">bandit19@bandit:~$</span><span class="w"> </span>./bandit20-do
<span class="go">Run a command as another user.
  Example: ./bandit20-do id
</span></pre></table></code></div></div><p>It runs a command as another user, and it gives us an example.</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">bandit19@bandit:~$</span><span class="w"> </span>./bandit20-do <span class="nb">id</span>
<span class="go">uid=11019(bandit19) gid=11019(bandit19) euid=11020(bandit20) groups=11019(bandit19)
</span></pre></table></code></div></div><p>We see that we ran <code class="language-plaintext highlighter-rouge">id</code> as bandit20, so we might as well read /etc/bandi_pass/bandit20 which contains bandi20’s password</p><div class="language-terminal highlighter-rouge"><div class="code-header"> <span data-label-text="Terminal"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">bandit19@bandit:~$</span><span class="w"> </span>./bandit20-do <span class="nb">cat</span> /etc/bandit_pass/bandit20
<span class="go">GbKksEFF4yrVs6il55v6gwY5aVje5f0j
</span><span class="gp">bandit19@bandit:~$</span><span class="w">
</span></pre></table></code></div></div><p>Thank you for taking the time to read my writeup, I hope you have learned something with this, if you have any questions or comments, please feel free to reach out to me. See you in the next hack :) .</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/overthewire/'>OverTheWire</a>, <a href='/categories/bandit/'>Bandit</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/overthewire/" class="post-tag no-text-decoration" >overthewire</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/bandit/" class="post-tag no-text-decoration" >bandit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OverTheWire+-+Bandit+-+Level+15+-%3E+Level+20+-+Nasrallah&url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-15-20%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OverTheWire+-+Bandit+-+Level+15+-%3E+Level+20+-+Nasrallah&u=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-15-20%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-15-20%2F&text=OverTheWire+-+Bandit+-+Level+15+-%3E+Level+20+-+Nasrallah" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnasrallahbaadi.github.io%2Fposts%2FBandit-15-20%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Preignition/">HackTheBox - Preignition</a><li><a href="/posts/HTB-Appointment/">HackTheBox - Appointment</a><li><a href="/posts/HTB-Sequel/">HackTheBox - Sequel</a><li><a href="/posts/HTB-Responder/">HackTheBox - Responder</a><li><a href="/posts/blunder/">HackTheBox - Blunder</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/hackthissite/">hackthissite</a> <a class="post-tag" href="/tags/hts/">hts</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/html/">html</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Bandit-0-5/"><div class="card-body"> <em class="small" data-ts="1644019200" data-df="ll" > Feb 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 0 -> Level 5</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. We are going to start Bandit series from OverTheWire. The Bandit wargame is aimed at absolute beginners. It will teach the basics needed to be...</p></div></div></a></div><div class="card"> <a href="/posts/Bandit-5-10/"><div class="card-body"> <em class="small" data-ts="1644192000" data-df="ll" > Feb 7, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 5 -> Level 10</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. In today’s episode we will be doing Level 5 -&amp;gt; Level 10 of Bandit from OverTheWire. Let’s connect to bandit5 and start. Level 5 -&amp;gt; Leve...</p></div></div></a></div><div class="card"> <a href="/posts/Bandit-10-15/"><div class="card-body"> <em class="small" data-ts="1644364800" data-df="ll" > Feb 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire - Bandit - Level 10 -> Level 15</h3><div class="text-muted small"><p> Description Hello l33ts, I hope you are doing well. In today’s episode, we will be doing Level 10 -&amp;gt; Level 15 of Bandit from OverTheWire. Let’s connect to bandit10 and start. Level 10 -&amp;gt; ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bandit-10-15/" class="btn btn-outline-primary" prompt="Older"><p>OverTheWire - Bandit - Level 10 -> Level 15</p></a> <a href="/posts/Bandit-20-25/" class="btn btn-outline-primary" prompt="Newer"><p>OverTheWire - Bandit - Level 20 -> Level 25</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/NasrallahBaadi">NasrallahBaadi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/hackthissite/">hackthissite</a> <a class="post-tag" href="/tags/hts/">hts</a> <a class="post-tag" href="/tags/basic/">basic</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/html/">html</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
